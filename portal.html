<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>portal</title>
  <script src="https://threejs.org/build/three.min.js"></script>
  <style>
    html,
    body {
      margin: 0;
      padding: 0;
      overflow: hidden;
    }

    canvas {
      display: block;
    }

    .navbar {
      display: block;
      position: absolute;


    }

    span {
      position: absolute;
      /* color: white; */
      top: 15px;
      left: 15px;

    }
  </style>
</head>

<body>
  <div id="navbar"><span>Portal</span></div>
  <script>
    var scene, sceneLight, portalLight, cam, renderer, clock, portalParticles = [],
      smokeParticles = [],theta;

    function initScene() {
      scene = new THREE.Scene();
theta =0;
      sceneLight = new THREE.DirectionalLight(0xffffff, 0.5);
      sceneLight.position.set(0, 0, 255);
      scene.add(sceneLight);

      portalLight = new THREE.PointLight(0x062d89, 30, 350, 1.7);
      portalLight.position.set(0, 0, 255);
      scene.add(portalLight);

      cam = new THREE.PerspectiveCamera(80, window.innerWidth / window.innerHeight, 1, 10000);
      cam.position.z = 1000;
      scene.add(cam);

      renderer = new THREE.WebGLRenderer();
      renderer.setClearColor(0x000000, 1);
      renderer.setSize(window.innerWidth, window.innerHeight);
      document.body.appendChild(renderer.domElement);
      renderer.render(scene, cam);

      particleSetup();
    }

    function particleSetup() {
      let loader = new THREE.TextureLoader();
      loader.load("data/smoke.png", function (texture) {
        portalGeo = new THREE.PlaneBufferGeometry(350, 350);
        portalMaterial = new THREE.MeshStandardMaterial({
          map: texture,
          transparent: true
        });
        smokeGeo = new THREE.PlaneBufferGeometry(1000, 1000);
        smokeMaterial = new THREE.MeshStandardMaterial({
          map: texture,
          transparent: true
        });

        //conical Spiral Algorithms
        for (let p = 880; p > 250; p--) {
          let particle = new THREE.Mesh(portalGeo, portalMaterial);
          particle.position.set(
            0.5 * p * Math.cos((4 * p * Math.PI) / 180),
            0.5 * p * Math.sin((4 * p * Math.PI) / 180),
            0.1 * p
          );

          particle.rotation.z = Math.random() * 360;
          portalParticles.push(particle);
          scene.add(particle);

        }
        for (let p = 0; p < 40; p++) {
          let particle = new THREE.Mesh(smokeGeo, smokeMaterial);
          particle.position.set(
            Math.random() * 1000 - 500,
            Math.random() * 400 - 200,
            25
          );

          particle.rotation.z = Math.random() * 360;
          particle.material.opacity = 0.4;
          portalParticles.push(particle);
          scene.add(particle);

        }
        clock = new THREE.Clock();
        animate();
        // renderer.render(scene, cam);
      })
    }

    function animate() {
      let delta = clock.getDelta();
      theta+=0.05;
      portalParticles.forEach(p => {
        p.rotation.z -= delta * 1.5;
      });
      smokeParticles.forEach(p => {
        p.rotation.z -= delta * 0.4;
      });
        portalLight.power = 350+Math.sin(theta)*350;
      
      renderer.render(scene, cam);
      requestAnimationFrame(animate);
    }
    initScene();
  </script>
</body>

</html>